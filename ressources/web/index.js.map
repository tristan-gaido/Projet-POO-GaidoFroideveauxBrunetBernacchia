{"version":3,"sources":["index.jsx"],"names":[],"mappings":"AAAA;AACA,IAAI,SAAS,IAAI,SAAJ,CAAc,qBAAd,CAAb;;AAGA,SAAS,SAAT,CAAmB,CAAnB,EAAsB;AAClB,WAAO,EAAE,OAAF,CAAU,QAAV,EAAoB,EAApB,EAAwB,WAAxB,EAAP;AACH;;AAED,SAAS,WAAT,CAAqB,KAArB,EAA4B;AACxB,WAAO,IAAP,CAAY,MAAM,MAAN,CAAa,SAAzB;AACH;;AAED,MAAM,IAAN,SAAmB,MAAM,SAAzB,CAAmC;AAC/B,gBAAY,KAAZ,EAAmB;AACf,cAAM,KAAN;AACA,aAAK,KAAL,GAAa,IAAb;AACH;;AAED,wBAAoB;AAChB,eAAO,SAAP,GAAmB,SAAS;AACxB,gBAAI,OAAO,KAAK,KAAL,CAAW,MAAM,IAAjB,CAAX;AACA,oBAAQ,GAAR,CAAY,IAAZ;AACA,iBAAK,QAAL,CAAc,IAAd;AACH,SAJD;AAKH;;AAED,aAAS;AACL,YAAI,KAAK,KAAL,KAAe,IAAnB,EAAyB;AACrB,mBAAO;AAAA;AAAA;AAAA;AAAA,aAAP;AACH;;AAED;AACA,aAAK,IAAI,IAAT,IAAiB,KAAK,KAAL,CAAW,IAAX,CAAgB,OAAjC,EAA0C;AACtC,iBAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,IAAX,CAAgB,WAAhB,KAAgC,KAAK,IAAxD,CADsC,CAC0B;AAChE,iBAAK,aAAL,GAAqB,KAAK,KAAL,CAAW,aAAX,KAA6B,KAAK,IAAvD,CAFsC,CAE0B;AAChE,gBAAI,YAAY,IAAhB,EAAsB;AAClB,qBAAK,OAAL,CAAa,OAAb,CAAqB,KAAK,MAA1B;AACH;AACJ;;AAED,YAAI,UAAU,EAAd;AACA,YAAI,KAAK,KAAL,CAAW,IAAX,CAAgB,OAAhB,CAAwB,MAAxB,IAAkC,CAAtC,EAAyC;AACrC,oBAAQ,IAAR,CAAa,MAAb;AACH,SAFD,MAEO;AACH,oBAAQ,IAAR,CAAa,MAAb;AACH;;AAED,YAAI,UAAU,EAAd;AACA,aAAK,MAAM,CAAC,CAAD,EAAI,MAAJ,CAAX,IAA0B,KAAK,KAAL,CAAW,OAAX,CAAmB,OAAnB,EAA1B,EAAwD;AACpD,oBAAQ,IAAR,CAAa,oBAAC,YAAD,IAAc,OAAO,MAArB,EAA6B,OAAO,IAAI,CAAxC,GAAb;AACH;;AAED,eACI;AAAA;AAAA,cAAK,IAAG,MAAR,EAAe,WAAW,QAAQ,IAAR,CAAa,GAAb,CAA1B;AACI,gCAAC,WAAD,IAAa,SAAS,KAAK,KAAL,CAAW,IAAX,CAAgB,OAAtC,GADJ;AAEI;AAAA;AAAA,kBAAK,IAAG,aAAR;AAAsB;AAAA;AAAA,sBAAM,IAAG,kBAAT;AAA6B,yBAAK,KAAL,CAAW;AAAxC,iBAAtB;AACK,uBADL;AAEK,qBAAK,KAAL,CAAW,QAAX,IAAuB,oBAAC,YAAD,IAAc,OAAM,MAApB,EAA2B,OAAM,EAAjC;AAF5B,aAFJ;AAMI;AAAA;AAAA,kBAAK,IAAG,OAAR;AACI,oCAAC,QAAD,IAAU,MAAM,KAAK,KAAL,CAAW,IAAX,CAAgB,SAAhC,GADJ;AAEI;AAAA;AAAA,sBAAK,IAAG,cAAR;AACI,wCAAC,SAAD,IAAW,OAAO,KAAK,KAAL,CAAW,IAAX,CAAgB,YAAlC,EAAgD,WAAW,IAA3D;AADJ;AAFJ;AANJ,SADJ;AAeH;AAvD8B;;AA2DnC,MAAM,WAAN,SAA0B,MAAM,SAAhC,CAA0C;AACtC,aAAS;AACL,cAAM,UAAU,KAAK,KAAL,CAAW,SAAX,EAAsB,GAAtB,CAA0B,KAAK,oBAAC,UAAD,IAAY,MAAM,CAAlB,GAA/B,CAAhB;AACA,gBAAQ,GAAR,CAAY,QAAQ,MAApB;AACA,YAAI,QAAQ,MAAR,GAAiB,CAArB,EAAwB;AACpB,mBACI;AAAA;AAAA,kBAAK,WAAU,cAAf;AACI;AAAA;AAAA,sBAAK,WAAU,KAAf;AACK,4BAAQ,KAAR,CAAc,CAAd,EAAiB,CAAC,EAAE,QAAQ,MAAR,GAAiB,CAAnB,CAAlB;AADL,iBADJ;AAII;AAAA;AAAA,sBAAK,WAAU,KAAf;AACK,4BAAQ,KAAR,CAAc,CAAC,EAAE,QAAQ,MAAR,GAAiB,CAAnB,CAAf,EAAsC,OAAtC;AADL;AAJJ,aADJ;AAUH,SAXD,MAWO;AACH,mBACI;AAAA;AAAA,kBAAK,WAAU,cAAf;AACI;AAAA;AAAA,sBAAK,WAAU,KAAf;AACK;AADL;AADJ,aADJ;AAOH;AACJ;AAxBqC;;AA4B1C,MAAM,SAAN,SACY,MACH,SAFT,CAEmB;AACf,aAAS;AACL,YAAI,UAAU,EAAd;AACA,aAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,KAAL,CAAW,EAA/B,EAAmC,GAAnC,EAAwC;AACpC,oBAAQ,IAAR,CAAa,6BAAK,WAAU,WAAf,EAA2B,OAAO,EAAC,iBAAkB,wBAAnB,EAAlC,GAAb;AACH;AACD,aAAK,IAAI,IAAI,KAAK,KAAL,CAAW,EAAxB,EAA4B,IAAI,KAAK,KAAL,CAAW,MAA3C,EAAmD,GAAnD,EAAwD;AACpD,oBAAQ,IAAR,CAAa,6BAAK,WAAU,WAAf,EAA2B,OAAO,EAAC,iBAAkB,6BAAnB,EAAlC,GAAb;AACH;;AAED,eACI;AAAA;AAAA,cAAK,WAAU,IAAf;AACK;AADL,SADJ;AAKH;AAfc;;AAmBnB,MAAM,YAAN,SAA2B,MAAM,SAAjC,CAA2C;AACvC,aAAS;AACL,YAAI,YAAY,QAAhB;AACA,YAAI,UAAU,SAAS;AACnB,mBAAO,IAAP,CAAY,KAAK,KAAL,CAAW,KAAvB;AACA,kBAAM,cAAN;AACH,SAHD;;AAKA,eACI;AAAA;AAAA;AACI,2BAAW,SADf;AAEI,yBAAS;AAFb;AAIK,iBAAK,KAAL,CAAW;AAJhB,SADJ;AAQH;AAhBsC;;AAoB3C,MAAM,IAAN,SAAmB,MAAM,SAAzB,CAAmC;AAC/B,aAAS;AACL,cAAM,CAAC,IAAD,EAAO,KAAP,IAAgB,KAAK,KAAL,CAAW,IAAjC;AACA,cAAM,WAAW,UAAU,IAAV,IAAkB,GAAlB,GAAwB,KAAzC;;AAEA,eACI;AAAA;AAAA;AACI,2BAAW,CAAC,MAAD,EAAS,MAAT,CAAgB,KAAK,KAAL,CAAW,OAA3B,EAAoC,IAApC,CAAyC,GAAzC,CADf;AAEI,uBAAO;AACH,qCAAkB,oBAAmB,QAAS,OAD3C;AAEH,4BAAS,GAAE,KAAK,KAAL,CAAW,MAAO;AAF1B,iBAFX;AAMI,yBAAS,MAAM;AACX,2BAAO,IAAP,CAAY,IAAZ;AACH,iBARL;AASI,qBAAI;AATR;AAUC;AAAA;AAAA,kBAAM,WAAU,MAAhB,EAAuB,KAAI,MAA3B;AAAmC;AAAnC;AAVD,SADJ;AAaH;;AAED,wBAAoB;AAChB,YAAI,KAAK,KAAK,IAAL,CAAU,EAAnB;AACA,YAAI,OAAO,KAAK,IAAL,CAAU,IAArB;AACA,YAAI,KAAK,WAAL,GAAmB,GAAG,WAAtB,GAAoC,GAAxC,EAA6C;AACzC,iBAAK,KAAL,CAAW,SAAX,GAAwB,SAAQ,MAAM,GAAG,WAAT,GAAuB,KAAK,WAAY,MAAxE;AACH;AACJ;AA1B8B;;AA8BnC,MAAM,aAAN,SAA4B,MAAM,SAAlC,CAA4C;AACxC,aAAS;AACL,eAAO;AAAA;AAAA;AACH,2BAAU,gBADP;AAEH,uBAAO,EAAC,iBAAkB,yBAAwB,UAAU,KAAK,KAAL,CAAW,IAArB,CAA2B,OAAtE,EAFJ;AAGH,qBAAI;AAHD;AAKH;AAAA;AAAA,kBAAM,KAAI,MAAV,EAAiB,WAAU,MAA3B;AAAmC,qBAAK,KAAL,CAAW;AAA9C;AALG,SAAP;AAOH;;AAED,wBAAoB;AAChB,YAAI,KAAK,KAAK,IAAL,CAAU,EAAnB;AACA,YAAI,OAAO,KAAK,IAAL,CAAU,IAArB;AACA,YAAI,KAAK,WAAL,GAAmB,GAAG,WAAtB,GAAoC,GAAxC,EAA6C;AACzC,iBAAK,KAAL,CAAW,SAAX,GAAwB,SAAQ,MAAM,GAAG,WAAT,GAAuB,KAAK,WAAY,MAAxE;AACH;AACJ;AAjBuC;;AAqB5C,MAAM,UAAN,SAAyB,MAAM,SAA/B,CAAyC;AACrC,aAAS;AACL,YAAI,UAAU,CAAC,aAAD,CAAd;AACA,YAAI,KAAK,KAAL,CAAW,IAAX,CAAgB,eAAhB,CAAJ,EAAsC;AAClC,oBAAQ,IAAR,CAAa,QAAb;AACH;AACD,YAAI,KAAK,KAAL,CAAW,IAAX,CAAgB,aAAhB,CAAJ,EAAoC;AAChC,oBAAQ,IAAR,CAAa,aAAb;AACH;;AAED,eACI;AAAA;AAAA,cAAK,WAAW,QAAQ,IAAR,CAAa,GAAb,CAAhB;AACI;AAAA;AAAA,kBAAK,WAAU,aAAf;AAA8B,qBAAK,KAAL,CAAW,IAAX,CAAgB,MAAhB;AAA9B,aADJ;AAEI;AAAA;AAAA,kBAAK,WAAU,KAAf;AACI;AAAA;AAAA;AACI,mCAAU,gBADd;AAEI,iCAAS,MAAM;AACX,mCAAO,IAAP,CAAY,KAAK,KAAL,CAAW,IAAX,CAAgB,MAAhB,CAAZ;AACH;AAJL;AAMI;AACI,mCAAU,WADd;AAEI,+BAAO,EAAC,iBAAkB,oBAAmB,KAAK,KAAL,CAAW,IAAX,CAAgB,MAAhB,CAAwB,OAA9D;AAFX,sBANJ;AAUI,wCAAC,aAAD,IAAe,MAAM,KAAK,KAAL,CAAW,IAAX,CAAgB,WAAhB,CAArB,GAVJ;AAWI,wCAAC,SAAD,IAAW,IAAI,KAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB,CAAf,EAAsC,QAAQ,KAAK,KAAL,CAAW,IAAX,CAAgB,QAAhB,CAA9C;AAXJ,iBADJ;AAcI;AAAA;AAAA,sBAAK,WAAU,SAAf;AACI,wCAAC,SAAD,IAAW,OAAO,KAAK,KAAL,CAAW,IAAX,CAAgB,SAAhB,CAAlB;AADJ;AAdJ,aAFJ;AAoBI;AAAA;AAAA,kBAAK,WAAU,MAAf;AACI,oCAAC,SAAD,IAAW,OAAO,KAAK,KAAL,CAAW,IAAX,CAAgB,MAAhB,CAAlB;AADJ;AApBJ,SADJ;AA0BH;AApCoC;;AAwCzC,MAAM,SAAN,SAAwB,MAAM,SAA9B,CAAwC;AACpC,aAAS;AACL;AACA,YAAI,KAAK,KAAL,CAAW,KAAX,CAAiB,MAAjB,KAA4B,CAAhC,EAAmC;AAC/B,mBAAO,CACH;AAAA;AAAA,kBAAK,WAAU,cAAf,EAA8B,KAAI,SAAlC;AACI;AAAA;AAAA,sBAAK,WAAU,SAAf;AACI,iDAAK,WAAU,YAAf;AADJ;AADJ,aADG,CAAP;AAOH;;AAED,YAAI,QAAQ,EAAZ;AACA,YAAI,CAAC,KAAK,KAAL,CAAW,SAAhB,EAA2B;AACvB,iBAAK,KAAL,CAAW,KAAX,CAAiB,IAAjB,CAAsB,CAAC,CAAD,EAAI,CAAJ,KAAU,EAAE,CAAF,EAAK,aAAL,CAAmB,EAAE,CAAF,CAAnB,CAAhC;AACH;;AAED,aAAK,MAAM,CAAC,CAAD,EAAI,IAAJ,CAAX,IAAwB,KAAK,KAAL,CAAW,KAAX,CAAiB,OAAjB,EAAxB,EAAoD;AAChD,gBAAI,UAAU,EAAd;AACA,gBAAI,IAAI,CAAJ,GAAQ,KAAK,KAAL,CAAW,KAAX,CAAiB,MAAzB,IAAmC,KAAK,CAAL,MAAY,KAAK,KAAL,CAAW,KAAX,CAAiB,IAAI,CAArB,EAAwB,CAAxB,CAAnD,EAA+E;AAC3E,wBAAQ,IAAR,CAAa,WAAb;AACH;AACD,kBAAM,IAAN,CAAW,oBAAC,IAAD,IAAM,MAAM,IAAZ,EAAkB,SAAS,OAA3B,EAAoC,QAAQ,IAAI,CAAhD,EAAmD,OAAO,CAA1D,GAAX;AACH;AACD,eAAQ,KAAR;AACH;AA1BmC;;AA6BxC,MAAM,QAAN,SAAuB,MAAM,SAA7B,CAAuC;AACnC,aAAS;AACL,YAAI,KAAK,KAAL,CAAW,IAAX,KAAoB,CAAxB,EAA2B;AACvB,mBAAO,CACH;AAAA;AAAA,kBAAK,WAAU,cAAf,EAA8B,KAAI,SAAlC;AACI;AAAA;AAAA,sBAAK,WAAU,SAAf;AACI,iDAAK,WAAU,YAAf;AADJ;AADJ,aADG,CAAP;AAOH;;AAED,YAAI,QAAQ,EAAZ;AACA,aAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,KAAL,CAAW,IAA/B,EAAqC,GAArC,EAA0C;AACtC,kBAAM,IAAN,CAAW,6BAAK,WAAU,MAAf,EAAsB,OAAO,EAAC,iBAAiB,4BAAlB,EAA7B,GAAX;AACH;AACD,eAAQ;AAAA;AAAA,cAAK,IAAG,WAAR;AAAqB;AAArB,SAAR;AACH;AAjBkC;;AAoBvC,SAAS,MAAT,CACI,oBAAC,IAAD,OADJ,EAEI,SAAS,cAAT,CAAwB,MAAxB,CAFJ","file":"index.js","sourcesContent":["// ouverture de la socket pour communiquer avec le serveur\nlet socket = new WebSocket(\"ws://localhost:3232\");\n\n\nfunction shortname(s) {\n    return s.replace(/[^\\w]/g, '').toLowerCase();\n}\n\nfunction clickButton(event) {\n    socket.send(event.target.innerText);\n}\n\nclass Main extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = null;\n    }\n\n    componentDidMount() {\n        socket.onmessage = event => {\n            let data = JSON.parse(event.data);\n            console.log(data);\n            this.setState(data);\n        }\n    }\n\n    render() {\n        if (this.state === null) {\n            return <div>Not connected to an active game.</div>;\n        }\n\n        // process players data\n        for (let data of this.state.game.players) {\n            data.turn_player = this.state.game.turn_player === data.name;   // identify turn player\n            data.active_player = this.state.active_player === data.name;    // identify active player\n            if ('weapon' in data) {\n                data.in_play.unshift(data.weapon);\n            }\n        }\n\n        let classes = [];\n        if (this.state.game.players.length >= 5) {\n            classes.push(\"row3\");\n        } else {\n            classes.push(\"row2\");\n        }\n\n        let buttons = [];\n        for (const [i, button] of this.state.buttons.entries()) {\n            buttons.push(<PlayerButton label={button} value={i + 1}/>);\n        }\n\n        return (\n            <div id=\"main\" className={classes.join(\" \")}>\n                <PlayersArea players={this.state.game.players}/>\n                <div id=\"instruction\"><span id=\"instruction_text\">{this.state.instruction}</span>\n                    {buttons}\n                    {this.state.can_pass && <PlayerButton label=\"Pass\" value=\"\"/>}\n                </div>\n                <div id=\"piles\">\n                    <DrawPile size={this.state.game.draw_pile}/>\n                    <div id=\"discard_pile\">\n                        <CardsList cards={this.state.game.discard_pile} keepOrder={true}/>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\n\nclass PlayersArea extends React.Component {\n    render() {\n        const players = this.props['players'].map(d => <PlayerInfo data={d}/>);\n        console.log(players.length);\n        if (players.length > 3) {\n            return (\n                <div className=\"players_area\">\n                    <div className=\"row\">\n                        {players.slice(0, ~~(players.length / 2))}\n                    </div>\n                    <div className=\"row\">\n                        {players.slice(~~(players.length / 2)).reverse()}\n                    </div>\n                </div>\n            )\n        } else {\n            return (\n                <div className=\"players_area\">\n                    <div className=\"row\">\n                        {players}\n                    </div>\n                </div>\n            )\n        }\n    }\n}\n\n\nclass HPBullets\n    extends React\n        .Component {\n    render() {\n        let bullets = [];\n        for (let i = 0; i < this.props.hp; i++) {\n            bullets.push(<div className=\"hp_bullet\" style={{backgroundImage: `url(images/bullet.png)`}}/>);\n        }\n        for (let i = this.props.hp; i < this.props.hp_max; i++) {\n            bullets.push(<div className=\"hp_bullet\" style={{backgroundImage: `url(images/bullet_grey.png)`}}/>);\n        }\n\n        return (\n            <div className=\"hp\">\n                {bullets}\n            </div>\n        );\n    }\n}\n\n\nclass PlayerButton extends React.Component {\n    render() {\n        let className = \"button\";\n        let onClick = event => {\n            socket.send(this.props.value);\n            event.preventDefault();\n        };\n\n        return (\n            <span\n                className={className}\n                onClick={onClick}\n            >\n                {this.props.label}\n            </span>\n        );\n    }\n}\n\n\nclass Card extends React.Component {\n    render() {\n        const [name, poker] = this.props.data;\n        const filename = shortname(name) + '_' + poker;\n\n        return (\n            <div\n                className={['card'].concat(this.props.classes).join(' ')}\n                style={{\n                    backgroundImage: `url(images/cards/${filename}.png)`,\n                    zIndex: `${this.props.zindex}`,\n                }}\n                onClick={() => {\n                    socket.send(name);\n                }}\n                ref=\"bg\"\n            ><span className='name' ref=\"name\">{name}</span></div>\n        );\n    }\n\n    componentDidMount() {\n        let bg = this.refs.bg;\n        let name = this.refs.name;\n        if (name.clientWidth / bg.clientWidth > .75) {\n            name.style.transform = `scale(${.75 * bg.clientWidth / name.clientWidth}, 1)`;\n        }\n    }\n}\n\n\nclass CharacterCard extends React.Component {\n    render() {\n        return <div\n            className=\"card character\"\n            style={{backgroundImage: `url(images/characters/${shortname(this.props.name)}.png)`}}\n            ref=\"bg\"\n        >\n            <span ref=\"name\" className='name'>{this.props.name}</span>\n        </div>\n    }\n\n    componentDidMount() {\n        let bg = this.refs.bg;\n        let name = this.refs.name;\n        if (name.clientWidth / bg.clientWidth > .75) {\n            name.style.transform = `scale(${.75 * bg.clientWidth / name.clientWidth}, 1)`;\n        }\n    }\n}\n\n\nclass PlayerInfo extends React.Component {\n    render() {\n        let classes = ['player_info'];\n        if (this.props.data['active_player']) {\n            classes.push('active');\n        }\n        if (this.props.data['turn_player']) {\n            classes.push('turn_player');\n        }\n\n        return (\n            <div className={classes.join(' ')}>\n                <div className=\"player_name\">{this.props.data['name']}</div>\n                <div className=\"row\">\n                    <div\n                        className=\"character_info\"\n                        onClick={() => {\n                            socket.send(this.props.data['name']);\n                        }}\n                    >\n                        <div\n                            className=\"card role\"\n                            style={{backgroundImage: `url(images/roles/${this.props.data['role']}.png)`}}\n                        />\n                        <CharacterCard name={this.props.data['character']}/>\n                        <HPBullets hp={this.props.data['hp']} hp_max={this.props.data['hp_max']}/>\n                    </div>\n                    <div className=\"in_play\">\n                        <CardsList cards={this.props.data['in_play']}/>\n                    </div>\n                </div>\n                <div className=\"hand\">\n                    <CardsList cards={this.props.data['hand']}/>\n                </div>\n            </div>\n        );\n    }\n}\n\n\nclass CardsList extends React.Component {\n    render() {\n        // if list is empty return an empty \"phantom\" card to keep space\n        if (this.props.cards.length === 0) {\n            return [\n                <div className=\"card phantom\" key=\"phantom\">\n                    <div className=\"wrapper\">\n                        <div className=\"background\"/>\n                    </div>\n                </div>\n            ];\n        }\n\n        let cards = [];\n        if (!this.props.keepOrder) {\n            this.props.cards.sort((x, y) => x[0].localeCompare(y[0]));\n        }\n\n        for (const [i, data] of this.props.cards.entries()) {\n            let classes = [];\n            if (i + 1 < this.props.cards.length && data[0] === this.props.cards[i + 1][0]) {\n                classes.push('duplicate');\n            }\n            cards.push(<Card data={data} classes={classes} zindex={i + 1} index={i}/>)\n        }\n        return (cards);\n    }\n}\n\nclass DrawPile extends React.Component {\n    render() {\n        if (this.props.size === 0) {\n            return [\n                <div className=\"card phantom\" key=\"phantom\">\n                    <div className=\"wrapper\">\n                        <div className=\"background\"/>\n                    </div>\n                </div>\n            ];\n        }\n\n        let cards = [];\n        for (let i = 0; i < this.props.size; i++) {\n            cards.push(<div className=\"card\" style={{backgroundImage: \"url(images/cards/back.png)\"}}/>);\n        }\n        return (<div id=\"draw_pile\">{cards}</div>);\n    }\n}\n\nReactDOM.render(\n    <Main/>,\n    document.getElementById('root')\n);\n"]}